[backend]
precision = single
rank-allocator = linear

[constants]
nu = 0.0005
Uin = 0.1
Vin = 0.0
Pc = 1.0
ac-zeta = 4.0

[solver]
system = ac-navier-stokes
order = 3

[solver-time-integrator]
formulation = dual
scheme = bdf2
pseudo-scheme = rk34
controller = none
pseudo-controller = none
tstart = 0
tend = 10.0
dt = 0.025
pseudo-dt = 0.0004
pseudo-niters-min = 1
pseudo-niters-max = 200
pseudo-resid-norm = l2
pseudo-resid-tol = 1e-5
pseudo-resid-tol-p = 1e-3
atol = 1e-6

[solver-dual-time-integrator-multip]
pseudo-dt-fact = 1.6
cycle = [(3, 1), (2, 1), (1, 1), (0, 2), (1, 2), (2, 2), (3, 5)]

[solver-interfaces]
riemann-solver = rusanov
ldg-beta = 0.5
ldg-tau = 0.1

[solver-interfaces-line]
flux-pts = gauss-legendre

[solver-elements-tri]
soln-pts = williams-shunn

[solver-elements-quad]
soln-pts = gauss-legendre

[soln-plugin-nancheck]
nsteps = 50

[soln-plugin-pseudostats]
flushsteps = 20
file = res.csv
header = true

[soln-plugin-walltimehistory]
flushsteps = 20
file = walltime
header = true

[soln-plugin-optimisationhistory]
dt-out = 50.0
flushsteps = 20
file = optim_hist

[soln-plugin-fluidforce-wall]
nsteps = 100
file = force.csv
header = true

[soln-plugin-writer]
dt-out = 50.0
basedir = .
basename = data/cylinder_{t:03.0f}

[soln-bcs-wall]
type = no-slp-wall

[soln-bcs-inlet]
type = ac-char-riem-inv
ac-zeta = 180
p = Pc
u = Uin
v = Vin

[soln-bcs-outlet]
type = ac-char-riem-inv
ac-zeta = 180
p = Pc
u = Uin
v = Vin

[soln-ics]
u = Uin
v = Vin
p = Pc
